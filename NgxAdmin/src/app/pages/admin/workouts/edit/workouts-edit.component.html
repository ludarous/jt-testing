<div class="row">
  <div class="col-lg-12">
    <nb-card>
      <nb-card-header>{{workout?.name}}</nb-card-header>
      <nb-card-body>
        <form class="form" *ngIf="workoutForm" [formGroup]="workoutForm" (submit)="saveWorkout()">
          <nb-stepper #stepper orientation="horizontal" [(selectedIndex)]="selectedStepperIndex">
            <nb-step [label]="'Základní údaje testu' | translate">

              <div class="form-group has-error">
                <label for="name">{{('Název' | translate)}}</label>
                <input type="text" class="form-control" id="name" [placeholder]="('Název' | translate)"
                       formControlName="name">
                <small *ngIf="!workoutForm.controls['name'].valid && workoutForm.controls['name'].touched"
                       class="form-text"></small>
              </div>

              <div class="form-group">
                <label for="description">{{('Popis' | translate)}}</label>
                <textarea type="text" class="form-control" id="description" [placeholder]="('Popis' | translate)"
                          formControlName="description"></textarea>
              </div>

              <div class="form-group">
                <label for="minAge">{{('Minimální věk' | translate)}}</label>
                <input class="form-control"
                       id="minAge" type="text" placeholder="Minimální věk" formControlName="minAge">
              </div>

              <div class="form-group">
                <label for="maxAge">{{('Maximální věk' | translate)}}</label>
                <input class="form-control"
                       id="maxAge" type="text" placeholder="Maximální věk" formControlName="maxAge">
              </div>

              <div class="d-flex justify-content-end">
                <button nbButton nbStepperNext>{{'Další' | translate}}</button>
              </div>
            </nb-step>
            <nb-step [label]="'Výběr aktivity pro test' | translate">;
              <ng-container *ngIf="workoutActivities">
                <ngx-drag-drop-lists
                  [sourceData]="workoutActivities"
                  [sourceFilter]="true"
                  [sourceFilterPlaceholder]="'Vyhledej aktivity'"
                  [sourceHeading]="'Všechny aktivity'"
                  [targetData]="selectedActivities"
                  [targetFilter]="true"
                  [targetFilterPlaceholder]="'Vyhledej aktivity'"
                  [targetHeading]="'Vybrané aktivity'"
                  [filterFields]="['name', 'description']">
                  <ng-template let-item="item">
                    <div class="ui-helper-clearfix">
                      <b>{{item.name}}</b>
                    </div>
                    <div class="activity-picklist-categories">
                      Kategorie:
                      <ng-container *ngFor="let category of item.categories; last as isLast">
                        <span>{{category.name}}</span><span *ngIf="!isLast">, </span>
                      </ng-container>
                    </div>
                  </ng-template>
                </ngx-drag-drop-lists>
              </ng-container>

              <div class="d-flex justify-content-between">
                <button nbButton nbStepperPrevious>{{'Předchozí' | translate}}</button>
                <button nbButton nbStepperNext>{{'Další' | translate}}</button>
              </div>
            </nb-step>
            <nb-step [label]="'Rekapitulace' | translate">
              <div class="form-group">
                <div class="text-hint">{{('Název' | translate)}}</div>
                <h5 class="text-body">{{workoutForm.controls['name'].value}}</h5>
              </div>

              <div class="form-group">
                <div class="text-hint">{{('Popis' | translate)}}</div>
                <h5 class="text-body">{{workoutForm.controls['description'].value}}</h5>
              </div>

              <div class="form-group">
                <div class="text-hint">{{('Minimální věk' | translate)}}</div>
                <h5 class="text-body">{{workoutForm.controls['minAge'].value}}</h5>
              </div>

              <div class="form-group">
                <div class="text-hint">{{('Maximální věk' | translate)}}</div>
                <h5 class="text-body">{{workoutForm.controls['maxAge'].value}}</h5>
              </div>

              <div class="form-group">
                <div class="text-hint">{{('Aktivity' | translate)}}</div>
                <div class="workout-activities-summary">
                  <span class="font-exo" *ngFor="let activity of selectedActivities; last as isLast">
                    {{activity.name}}<span style="margin-right: 5px;" *ngIf="!isLast">,</span>
                  </span>
                </div>
              </div>

              <div class="d-flex justify-content-between">
                <button nbButton nbStepperPrevious>{{'Předchozí' | translate}}</button>
                <button nbButton
                        status="success"
                        [disabled]="submitted || !workoutForm.valid"
                        [class.btn-pulse]="submitted">
                  {{'Uložit' | translate}}
                </button>
              </div>
            </nb-step>
          </nb-stepper>
        </form>
      </nb-card-body>
    </nb-card>
  </div>
</div>
